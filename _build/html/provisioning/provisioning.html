

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Provisioning &mdash; jwtest 1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/my_theme.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="jwtest 1 documentation" href="../index.html"/>
        <link rel="next" title="Infrastructure" href="../infrastructure/infrastructure.html"/>
        <link rel="prev" title="Getting Started" href="../getting_started/getting_started.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.svg" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Provisioning</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#provisioning-concepts">Provisioning Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#instances">Instances</a></li>
<li class="toctree-l3"><a class="reference internal" href="#containers-nodes-virtual-machines">Containers / Nodes / Virtual Machines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hosts-servers">Hosts / Servers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#apps">Apps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#templates">Templates</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id1">Instances</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#instance-details">Instance Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="#instance-actions">Instance Actions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#actions">Actions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performing-instance-actions">Performing Instance Actions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#notes">Notes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id2">Apps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-apps">Creating Apps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id3">Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="#virtual-images">Virtual Images</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#image-types">Image Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-virtual-images">Configuring Virtual Images</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#system-images">System Images</a></li>
<li class="toctree-l4"><a class="reference internal" href="#user-images">User Images</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#provisioning-images">Provisioning Images</a></li>
<li class="toctree-l3"><a class="reference internal" href="#add-virtual-images">Add Virtual Images</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#library">Library</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id4">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#instance-types">Instance Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#node-types">Node Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scripts-templates">Scripts &amp; Templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#layouts">Layouts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#option-types">Option Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#option-list">Option List</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#migrations">Migrations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#migration-types">Migration Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hypervisor-to-hypervisor">Hypervisor to Hypervisor</a></li>
<li class="toctree-l4"><a class="reference internal" href="#virtual-image-extract">Virtual Image Extract</a></li>
<li class="toctree-l4"><a class="reference internal" href="#live-stream">Live Stream</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#add-migration">Add Migration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#manually-start-migration">Manually Start Migration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#remove-migration">Remove Migration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#deployments">Deployments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#getting-started">Getting Started</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#git">Git</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fetch">Fetch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#deploying-to-an-instance">Deploying to an Instance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rolling-backwards-and-forwards">Rolling Backwards and Forwards</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#offloading-storage">Offloading Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#add-deployment">Add Deployment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id7">Add Deployment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-version">Add Version</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#edit-deployment">Edit Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#delete-deployment">Delete Deployment</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/infrastructure.html">Infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../administration/administration.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monitoring/monitoring.html">Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logs/logging.html">Logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../backups/backups.html">Backups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operations/operations.html">Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../services/services.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../integration_guides/integration_guides.html">Integration Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/faqs.html">FAQ’s</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes/release_notes.html">Release Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">jwtest</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Provisioning</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/provisioning/provisioning.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="provisioning">
<h1>Provisioning<a class="headerlink" href="#provisioning" title="Permalink to this headline">¶</a></h1>
<p>There are several capabilities in the |morpheus| provisioning engine.
Things ranging from application / service deployments via containers,
virtual machines, and even bare metal. Deployment management and app
template construction are also core aspects of the provisioning engine.
Take advantage of custom tasks and workflows within any environment by
building tasks and workflows from those tasks. There is a lot of
information to cover with regards to provisioning but |morpheus| makes
it intuitive and smooth.</p>
<div class="section" id="provisioning-concepts">
<h2>Provisioning Concepts<a class="headerlink" href="#provisioning-concepts" title="Permalink to this headline">¶</a></h2>
<p>|morpheus| is a powerful infrastructure agnostic Cloud Application
Management Platform. As a result of this there are some differing
concepts compared to other CMP platforms in the space. It is here that
it is important to notice the qualification difference between
|morpheus| and other platforms.</p>
<p>|morpheus| refers to itself as a CAMP (Cloud Application Management
Platform) as opposed to a (Cloud Management Platform). While that may
seem minor, it actually is a big deal. Many CMP based applications start
at the IaaS layer and work up to the application layer (often needing
additional PaaS) architectures to fill out the model. |morpheus| was
designed from a middle-ground perspective. As such some concepts are a
bit different. This provides a more complete platform that allows for
greater capabilities out of the box as will be seen when these concepts
are covered.</p>
<div class="section" id="instances">
<h3>Instances<a class="headerlink" href="#instances" title="Permalink to this headline">¶</a></h3>
<p>|morpheus| starts with provisioning Instances. In some platforms an
Instance is representative of a singular object like a “Virtual Machine”
in Amazon. In |morpheus| , this concept was rethought. An Instance is
more of a representation of a Resource or Service. This service may
involve several virtual machines or even several docker containers.</p>
<p>For example, in the morpheus Instance wizard Mongo is an option and
contains several “Instance Configurations”. One of these configurations
is a full Mongo cluster consisting of either seven virtual machines or
seven docker containers. Rather than representing these directly as
seven individual “instances”, |morpheus| groups them together into a
singular instance of a service that contains multiple containers or
virtual machines. This even allows for instance actions that can be
performed to expand capacity on an instance (either horizontally or
vertically). In the past, a database server may have been representative
of a singular server, but this model has drastically changed in a big
data world. This same concept also can apply to something like a simple
Apache web server where there are 10 copies of a webserver horizontally
scaled out to handle traffic.</p>
<p>When viewing an instance detail page, one is able to look at
details/statistics specific to a virtual machine or container.
|morpheus| simply helps simplify the management model for tracking these
services.</p>
</div>
<div class="section" id="containers-nodes-virtual-machines">
<h3>Containers / Nodes / Virtual Machines<a class="headerlink" href="#containers-nodes-virtual-machines" title="Permalink to this headline">¶</a></h3>
<p>In relation to <code class="docutils literal"><span class="pre">Instances</span></code>, an instance can have many nodes. A node is
a generic representation of a container or a virtual machine. In most
cases, |morpheus| will represent a node as a Container or Virtual
Machine depending on the provisioning engine used for the instance. Node
is just a generic naming representation when referring to these types of
items. The public developer API, however, often refers to both virtual
machines and docker containers as <code class="docutils literal"><span class="pre">Containers</span></code>. The UI was since
updated to better deliniate this concept for easier understanding but In
essence the name is valid for both concepts of containerized
environments as well as Virtual Machines. In fact, one can even think of
a Docker Host as a Hypervisor (which we do).</p>
</div>
<div class="section" id="hosts-servers">
<h3>Hosts / Servers<a class="headerlink" href="#hosts-servers" title="Permalink to this headline">¶</a></h3>
<p>This concept is mostly tailored to users of morpheus responsible for
managing and maintaining the underlying infrastructure integrations. A
Host typically refers to a Docker Host in which a container in an
instance is running, or a hypervisor virtual machines can be provisioned
onto. A Server is the underlying general representation of a physical or
virtual server. It could be a Host representation , a Virtual Machine,
or even a Bare Metal delineation.</p>
<p>When a user provisions a vm based instance, a corresponding server
record is created to represent the link to the actual resource via the
underlying provisioning engine. This may seem a bit odd but provides an
aspect of |morpheus| that is quite powerful. This singular concept is
what allows |morpheus| to injest “Brownfield” environments. We do not
need to start clean. |morpheus| can be integrated into existing
environments and manage existing virtual machines. The way |morpheus| 
does this is by periodically syncing existing vms from the added cloud
integrations. A server record will be created and periodically updated
(5 minutes typically) with realtime information and changes. This, in
essence, provides CMDB based capabilities as well. When a server is
discovered, the user (given the appropriate access) can convert the
virtual machine to a managed instance. When this is done a corresponding
Instance is made in the provisioning section of |morpheus| and the
|morpheus| Agent can also optionally be installed to provide more
refined guest operating system level statistics and logging.</p>
</div>
<div class="section" id="apps">
<h3>Apps<a class="headerlink" href="#apps" title="Permalink to this headline">¶</a></h3>
<p>On top of all the previous concept, |morpheus| provides an Apps layer.
An App is a collection of Instances linked together via application
tiers. Tiers allow the user to define segregated sections of
connectivity between the various elements / instances within an
application. Once these instances are all linked together in an
application concept, this may affect Instance environments and provide
service discovery capabilities for them to cross connect. There are
several service discovery aspects within morpheus as well as
integrations with services like Consul.</p>
</div>
<div class="section" id="templates">
<h3>Templates<a class="headerlink" href="#templates" title="Permalink to this headline">¶</a></h3>
<p>A template is typically referred to as an Application Template. It
allows a user to define an application structure for easy
reproducibility and deployment into various environments. They can be
used to mix and match various instance types to provision an application
dependent on multiple layers of services.</p>
</div>
</div>
<div class="section" id="id1">
<h2>Instances<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Instances is a great starting point for taking advantage of self service
features and spinning up both vms and containers. In |morpheus| it may
be advisable to cover the definition of a few terms used within the
application so as to reduce confusion.</p>
<ul class="simple">
<li><em>Instance</em> - A set of containers or virtual machines that can
correlate to a single horizontally scalable entity or a service suite
like a database. (It is important to note that an instance can
contain one or more containers/vms depending on the instance type and
configuration).</li>
<li><em>Container</em> - Typically a docker container provisioned via a
|morpheus| Docker host.</li>
<li><em>Virtual Machine</em> - A virtualized compute server provisioned onto
various hypervisor hosts.</li>
</ul>
<p>The top of the main Instances page shows overall statistic for the
listed Instances, including count, status, and resource utilization.</p>
<p>Please note the instances listed are determined by group access and role
permissions. Also, certain features shown may be hidden or disabled
depending on user permissions.</p>
<p>You can search for instances by name, or filter by group, instance type,
or category.</p>
<p>The instance list contains important information about each instance,
including the instance name, environment tag, instance type icon, ip and
port info, instance version, the number of virtual machines or
containers in the instance, the group the instance is in, and the cloud
or clouds the instance is in.</p>
<div class="section" id="instance-details">
<h3>Instance Details<a class="headerlink" href="#instance-details" title="Permalink to this headline">¶</a></h3>
<p>The instance detail page is where you can view and fully manage an
instance. To get to an instance detail page, navigate to provisioning,
instances, and click on an instance. Please note instance details and
actions differ between instance types and user permissions.</p>
<p>There are several sections within an Instance page that provide useful
capabilities to the user.</p>
<ul class="simple">
<li>Summary - Stats and status information</li>
<li>Deploy - Track deployment history for instance types that support
deployments or manually kick off a deployment (only visible for
instance types that support deployments)</li>
<li>Settings - Some instance types support custom configuration settings
(i.e. mysql presents the my.ini)</li>
<li>Network - Useful for configuring security groups and access to the
instance.</li>
<li>Monitoring - Quick summary of the monitoring system and all checks
that were configured to test teh state of the instance</li>
<li>Backups - Quick backup dashboard. Useful for viewing historical
backups as well as kicking off new ones.</li>
<li>Logs - View all aggregated logs from the containers or vms
representing the instance.</li>
<li>Environment - View the environment variables presented to the
instances or exported by the instances via Apps (more on this in the
Apps section). Even see Imported environment variables that may be
referenced by the running instance.</li>
<li>Scale - For instances that support load balancing and auto scaling.
Easily configure auto scaling thresholds and load balancer settings
that pertain to a particular instance.</li>
<li>Console - Access the instance or container via a clientless Console
supporting SSH, RDP, VNC, and even hypervisor level remote consoles.</li>
</ul>
</div>
<div class="section" id="instance-actions">
<h3>Instance Actions<a class="headerlink" href="#instance-actions" title="Permalink to this headline">¶</a></h3>
<p>Instance actions allow you to perform numerous management tasks on
instances. The actions available depend on the instance type,
hypervisor, roles permissions, and instance state.</p>
<dl class="docutils">
<dt>Edit</dt>
<dd>Edit the Name, Description, Environment, or Group for the Instance.</dd>
<dt>Delete</dt>
<dd>Deletes the Instance.</dd>
</dl>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Deleting an Instance will delete associated VM’s or Containers and cannot be undone. To delete instances without deleting associated VM’s, delete the VM from the Infrastructure section and uncheck “Remove Infrastructure” while checking “Remove Associated Instances” in the delete modal options.</p>
</div>
<div class="section" id="actions">
<h4>Actions<a class="headerlink" href="#actions" title="Permalink to this headline">¶</a></h4>
<p>Available options in the Actions dropdown can include:</p>
<dl class="docutils">
<dt>Suspend</dt>
<dd>Puts the VM in a suspended state without shutting down the OS.</dd>
<dt>Stop/Start/Restart Service</dt>
<dd>Stops, Starts or Restarts the service associated with the Instance Type.</dd>
<dt>Stop/Start/Restart Server</dt>
<dd>Stops, Starts or Restarts the Virtual Machine.</dd>
<dt>Lock/Unlock Instance</dt>
<dd>A locked instance cannot be deleted until it is unlocked.</dd>
<dt>Import As Image</dt>
<dd>Creates a Virtual Image template from the Instance at its current state and adds it to the Virtual Image library with corresponding metadata.</dd>
<dt>Reconfigure</dt>
<dd>The Reconfigure action allows service plan, disk, cpu, ram, networks and storage controller changes. Available options depend on the instance type and service plan configuration. Some resize actions require an instance restart.</dd>
<dt>Clone</dt>
<dd>Creates a new Instance from the Instance at its current state.</dd>
<dt>Backup</dt>
<dd>Immediately executes a backup of the Instance. Only available for Instances with backups enabled.</dd>
<dt>Run Workflow</dt>
<dd>Presents workflow options and then immediately runs selected Workflow on the Instance. Workflows can be created in the <code class="docutils literal"><span class="pre">Provisioning</span> <span class="pre">-&gt;</span> <span class="pre">Automation</span></code> section.</dd>
<dt>Run Script</dt>
<dd>Presents Script options and immediately executes selected Script on the Instance. Scripts can be created in the <code class="docutils literal"><span class="pre">Provisioning</span> <span class="pre">-&gt;</span> <span class="pre">Library</span></code> section.</dd>
<dt>Apply Template</dt>
<dd>Presents Template options and immediately applies selected Template to the Instance. Templates can be created in the <code class="docutils literal"><span class="pre">Provisioning</span> <span class="pre">-&gt;</span> <span class="pre">Library</span></code> section.</dd>
<dt>Add Node</dt>
<dd>Adds an additional node to the configuration. Additional options and configurations are required in the add node wizard depending on instance configuration and type.</dd>
<dt>Eject Disk</dt>
<dd>Ejects attached disk/iso.</dd>
<dt>Add Slave</dt>
<dd>Adds a database slave in the Instance.</dd>
<dt>Change Master</dt>
<dd>Changes the database Master node in an Instance.</dd>
</dl>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Scrolling down in the Actions dropdown may be necessary to see all options.</p>
</div>
</div>
<div class="section" id="performing-instance-actions">
<h4>Performing Instance Actions<a class="headerlink" href="#performing-instance-actions" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li>Select the Provisioning link in the navigation bar.</li>
<li>Click the Instance from the list of instances you wish to perform an action on.</li>
<li>Click the Actions drop down button and select an Action.</li>
</ol>
</div>
<div class="section" id="notes">
<h4>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h4>
<p>Every Instance has a Notes section for adding useful information about
the Instance. Notes can be added by selecting the <code class="docutils literal"><span class="pre">ADD</span> <span class="pre">NOTES</span></code> button
on the bottom of Instance Detail pages. Existing notes can be edited by
selecting the <code class="docutils literal"><span class="pre">EDIT</span> <span class="pre">NOTES</span></code></p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Markdown Syntax is supported in Instance Notes.</p>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h2>Apps<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Apps allow instances having general relationships to be grouped in a
clean and organized manner. App functionality enables full control of
which instances belong in an app as well setting Firewall and Access
Control List (ACL) rules. Use Apps to structure all necessary components
into a single place. Add checks and groups for web servers, database
nodes, etc.</p>
<div class="section" id="creating-apps">
<h3>Creating Apps<a class="headerlink" href="#creating-apps" title="Permalink to this headline">¶</a></h3>
<p>To create and App, click “+ADD APP” on the right side of the main Apps
section in Provisioning.</p>
<img alt="../_images/howtocreateapp-ee817.png" src="../_images/howtocreateapp-ee817.png" />
<p>Next fill in the Setup tab with your App name, optional description, and
select a resource group:</p>
<img alt="../_images/howtocreateapp-7f57d.png" src="../_images/howtocreateapp-7f57d.png" />
<p>In the LAYOUT tab, you have the option of selecting a Template (created
in the Templates section) or Add Tiers. To use a Template, select a
Template from the dropdown and your app will populate in the layout
section. You can add to, modify, edit your template, or simply click
next of the Template is fully configured:</p>
<img alt="../_images/howtocreateapp-680f5.png" src="../_images/howtocreateapp-680f5.png" />
<p>To create an app without a Template, start by adding a Tier by clicking “+ ADD TIER”. Name the Tier by selecting a pre-populated, recently used, or add a new/custom Tier name:</p>
<img alt="../_images/howtocreateapp-07e66.png" src="../_images/howtocreateapp-07e66.png" />
<p>For each Tier added, a new Tier container is created, and the Tier is
added to the Tier list:</p>
<img alt="../_images/howtocreateapp-8b54f.png" src="../_images/howtocreateapp-8b54f.png" />
<p>Next click +Add Instance to add a new instance, or select from existing
instances using the Existing tab. Multiple instances can be added to a
single container as well:</p>
<img alt="../_images/howtocreateapp-ab55e.png" src="../_images/howtocreateapp-ab55e.png" />
<p>After adding all instances, click out of the Add Instance pop up to
return to the layout page. Continue to add all Tiers and instances for
your App:</p>
<img alt="../_images/howtocreateapp-119c3.png" src="../_images/howtocreateapp-119c3.png" />
<p>To configure new or existing instances, hover over the instance name in
the Tier List and click the Settings gear icon. (Instances can also be
fully configured/edited in the Configure tab by clicking next in the
bottom right):</p>
<img alt="../_images/howtocreateapp-f3949.png" src="../_images/howtocreateapp-f3949.png" />
<p>To link Tiers, hover over a Tier, click the blue circle at the top of a
Tier and drag the arrow over the top of the Tier you would like to link:</p>
<img alt="../_images/howtocreateapp-b92f5.png" src="../_images/howtocreateapp-b92f5.png" />
<p>To remove a Tier or Instance, click the trash icon. Once your App is
built, click Next in the bottom right.</p>
<p>In the Configure tab, you can fully configure your instances if they are
not configured yet, or edit the configurations. If the app was built
with Existing instances, no configuration options are presented:</p>
<img alt="../_images/howtocreateapp-5fd9f.png" src="../_images/howtocreateapp-5fd9f.png" />
<p>Once your App is ready, click Complete in the bottom right and your App
will be created, appear in the App section, and if new instances were
used, the instances will be provisioned:</p>
<img alt="../_images/howtocreateapp-20fbf.png" src="../_images/howtocreateapp-20fbf.png" />
</div>
</div>
<div class="section" id="id3">
<h2>Templates<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="virtual-images">
<h2>Virtual Images<a class="headerlink" href="#virtual-images" title="Permalink to this headline">¶</a></h2>
<p><cite>Provisioning -&gt; Virtual Images</cite></p>
<div class="section" id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h3>
<p>The Virtual Image section displays a list of all images, local and synced, that are available to deploy. |morpheus| includes a rich catalog of pre-configured System Images available for every cloud type. User Images are automatically synced from Cloud Integrations and added to the Virtual Images section. Images can also be uploaded directly into |morpheus| via local file or url. Amazon and Azure Marketplace images can also be added to the Virtual Images Section.</p>
</div>
<div class="section" id="image-types">
<h3>Image Types<a class="headerlink" href="#image-types" title="Permalink to this headline">¶</a></h3>
<p>|morpheus| provides a vast <em>System Image</em> repo with pre-configured images for every Cloud. All other images are <em>User Images</em>. User images can be added directly to |morpheus| , or automatically synced from integrated clouds. It is important to configure synced User Images for metadata, including specifying the Platform and User Credentials, prior to provisioning. Provisioning a User Image that has not been configured may result in failed provisioning.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Synced User Images need to be configured prior to provisioning.</p>
</div>
</div>
<div class="section" id="configuring-virtual-images">
<h3>Configuring Virtual Images<a class="headerlink" href="#configuring-virtual-images" title="Permalink to this headline">¶</a></h3>
<div class="section" id="system-images">
<h4>System Images<a class="headerlink" href="#system-images" title="Permalink to this headline">¶</a></h4>
<p>System Images are pre-configured with metadata and have Cloud-Init or Cloudbase-Init installed. These images are ready to be provisioned with no configuration necessary. It is highly recommended to populated the <cite>Administration -&gt; Provisioning -&gt; Cloud-Init</cite> section with user data prior to provisioning, as the user and password/key will be added to all Instances provisioned from System Images. Users can also be added during provisioning in the <cite>Add User</cite> provisioning wizard section.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Editing System Images is disabled.</p>
</div>
</div>
<div class="section" id="user-images">
<h4>User Images<a class="headerlink" href="#user-images" title="Permalink to this headline">¶</a></h4>
<p>Typically |morpheus| does not have sufficient metatdata to successfully provision synced User Images. After integrating clouds and User Images have synced, it is highly recommended to configure the images prior to provisioning.</p>
<p><strong>To edit and configure an existing Virtual Image:</strong></p>
<ol class="arabic simple">
<li>Select <cite>Actions - Edit</cite> in the Virtual Images list, or <cite>Edit</cite> on a Virtual Image detail page.</li>
<li>Configure the following on the Image:</li>
</ol>
<dl class="docutils">
<dt>Name</dt>
<dd>Name of the Virtual Image in |morpheus| . This can be changed from the name of the Image, but editing will not change the name of the actual Image.</dd>
<dt>Operating System</dt>
<dd>Specifies the Platform and OS of the image. All Windows images will need to have Operating System specified on the Virtual Image, as |morpheus| will assign Linux as the Platform for all Images without Operating System specified.</dd>
<dt>Cloud Init Enabled?</dt>
<dd>On by default, uncheck for any Image that does not have Cloud-Init or Cloudbase-Init installed.</dd>
<dt>Install Agent</dt>
<dd>On by default, uncheck to skip Agent install. Note this will result in the loss of utilization statistics, logs, script execution, and monitoring. (Some utilization stats are collected for agent-less hosts and vm’s from VMware and AWS clouds).</dd>
<dt>Username</dt>
<dd>Existing Username on the Image. This is required for authentication, unless |morpheus| is able to add user data via Cloud-Init, Cloudbase-Init, or guest processes (VMware).</dd>
<dt>Password</dt>
<dd>Password for the Existing User on the image.</dd>
<dt>Cloud-Init User Data</dt>
<dd>Accepts what would go in runcmd and can assume bash syntax.</dd>
<dt>Permissions</dt>
<dd>Set Tenant permissions in a multi-tenant |morpheus| environment. No impact on single-tenant environments.</dd>
<dt>Auto Join Domain?</dt>
<dd>Enable to have instances provisioned with this image auto-join configured domains (Windows only).</dd>
<dt>VirtIO Drivers Loaded?</dt>
<dd>Enable if VirtIO Drivers are installed on the image for provisioning to KVM based Hypervisors.</dd>
<dt>Force Guest Customization?</dt>
<dd>VMware only, forces sys-prep on image during provisioning.</dd>
<dt>Trial Version</dt>
<dd>Enable to automatically re-arm the expiration on Windows Trial Images during provisioning.</dd>
</dl>
<ol class="arabic simple" start="3">
<li>Save Changes</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Cloud-Init is enabled by default on all Images. Images without Cloud-Init or Cloudbase-Init installed must have the <cite>cloud-init</cite> flag disabled on the Virtual Image setting or Provisioning may fail.</p>
</div>
</div>
</div>
<div class="section" id="provisioning-images">
<h3>Provisioning Images<a class="headerlink" href="#provisioning-images" title="Permalink to this headline">¶</a></h3>
<p>When provisioning a System Image for the first time, |morpheus| will download and stream the image from S3 to the source Cloud if the image is not local to the Cloud. The Image will also be cached on the |morpheus| Appliance under /var/opt/morpheus/vm/vmcache. Subsequent provisions of the image will use the created template in the Cloud or the cached local Image if the images does not exist in the selected Cloud, in which case the cached Image will be copied to the Cloud.</p>
<p>When using Images that already exist in the destination cloud, such as synced, marketplace, or previously copied images, no image transfer between the |morpheus| Appliance and destination cloud will take place.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The |morpheus| Appliance must be able to download from Amazon S3 when provisioning System Images for the first time.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The |morpheus| Appliance must be able reach and resolve the destination Host when provisioning System Images or uploaded Images for the first time. This included being able to resolve ESXi host names in VMware VCenter clouds, and reach the destination ESXi host over port 443.</p>
</div>
</div>
<div class="section" id="add-virtual-images">
<h3>Add Virtual Images<a class="headerlink" href="#add-virtual-images" title="Permalink to this headline">¶</a></h3>
<p>Virtual Images can be upload to |morpheus| from local files or URL’s. Amazon and Azure Marketplace metadata can also be added to the Virtual Images library, enabling the creation of custom catalog Instance Type from Marketplace images (no image is transferred to |morpheus| when adding Marketplace images).</p>
<p>To Add Virtual Image:</p>
<ol class="arabic simple">
<li>Select <cite>+ Add Virtual Image</cite> in the Virtual Images page.</li>
<li>Select Image format:</li>
</ol>
<blockquote>
<div><ul class="simple">
<li>Amazon AMI</li>
<li>Azure Marketplace</li>
<li>Digital Ocean</li>
<li>ISO</li>
<li>PXE Boot</li>
<li>QCOW2</li>
<li>RAW</li>
<li>VHD</li>
<li>VirtualBox</li>
<li>VirtualBox (vdi)</li>
<li>VMware (vmdk/ovf/ova)</li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="3">
<li>Configure the following on the Virtual Image:</li>
</ol>
<dl class="docutils">
<dt>Name</dt>
<dd>Name of the Virtual Image in |morpheus| . This can be changed from the name of the Image, but editing will not change the name of the actual Image.</dd>
<dt>Operating System</dt>
<dd>Specifies the Platform and OS of the image. All Windows images will need to have Operating System specified on the Virtual Image, as {norpheus} will assign Linux as the Platform for all Images without Operating System specified.</dd>
<dt>Cloud Init Enabled?</dt>
<dd>On by default, uncheck for any Image that does not have Cloud-Init or Cloudbase-Init installed.</dd>
<dt>Install Agent</dt>
<dd>On by default, uncheck to skip Agent install. Note this will result in the loss of utilization statistics, logs, script execution, and monitoring. (Some utilization stats are collected for agent-less hosts and vm’s from VMware and AWS clouds).</dd>
<dt>Username</dt>
<dd>Existing Username on the Image. This is required for authentication, unless |morpheus| is able to add user data via Cloud-Init, Cloudbase-Init, or guest processes (VMware).</dd>
<dt>Password</dt>
<dd>Password for the Existing User on the image.</dd>
<dt>Storage Provider</dt>
<dd>Location where the Virtual Image will be stored. Default Virtual Image Storage location is /var/opt/morpheus/morpheus-ui/vms. Additional Storage Providers can be configured in <cite>Infrastructure -&gt; Storage</cite>.</dd>
<dt>Cloud-Init User Data</dt>
<dd>Accepts what would go in runcmd and can assume bash syntax.</dd>
<dt>Permissions</dt>
<dd>Set Tenant permissions in a multi-tenant |morpheus| environment. No impact on single-tenant environments.</dd>
<dt>Auto Join Domain?</dt>
<dd>Enable to have instances provisioned with this image auto-join configured domains (Windows only).</dd>
<dt>VirtIO Drivers Loaded?</dt>
<dd>Enable if VirtIO Drivers are installed on the image for provisioning to KVM based Hypervisors.</dd>
<dt>Force Guest Customization?</dt>
<dd>VMware only, forces sys-prep on image during provisioning.</dd>
<dt>Trial Version</dt>
<dd>Enable to automatically re-arm the expiration on Windows Trial Images during provisioning.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Default Storage location is /var/opt/morpheus/morpheus-ui/vms. Additional Storage Providers can be configured in <cite>Infrastructure -&gt; Storage</cite>. Ensure local folders are owned by morpheus-app.morpheus-app if used.</p>
</div>
<ol class="arabic simple" start="4">
<li>Upload Image</li>
</ol>
<blockquote>
<div><p>Images can be uploaded by File or URL:</p>
<dl class="docutils">
<dt><em>File</em></dt>
<dd>Drag and Drop the image file, or select “Add File” to select the image file.</dd>
<dt><em>Url</em></dt>
<dd>Select the URL radio button, and enter URL of the Image.</dd>
</dl>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">|morpheus| provides a file upload progress. The Virtual Image configuration can be saved while the upload is in progress, and the upload will finish in the background.</p>
</div>
</div>
</div>
<div class="section" id="library">
<h2>Library<a class="headerlink" href="#library" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id4">
<h3>Overview<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>The Library section is used to add virtual images as custom instances to the provisioning catalog. The Library Section is composed of:</p>
<ul class="simple">
<li>Instance Types</li>
<li>Layouts</li>
<li>Node Types</li>
<li>Option Types</li>
<li>Option Lists</li>
<li>Templates</li>
<li>Scripts</li>
</ul>
<p>Uploaded or synced images from the virtual images section are added to nodes, a node or multiple nodes are added to layouts, and layouts are added to Instance Types. Scripts and Templates can be attached to nodes, with phased execution options for scripts.</p>
</div>
<div class="section" id="instance-types">
<h3>Instance Types<a class="headerlink" href="#instance-types" title="Permalink to this headline">¶</a></h3>
<p>Types___Library___|morpheus| _salt_library_item.png</p>
<p>Adding an Instance Type creates a new Library Item category. Multiple layouts can be added to an instance type, and these layout can have different nodes attached. The instance wizard will present the layout options compatible with the selected cloud. If cloud selection is turned off, all layouts will be presented for all cloud types accessible by the user.</p>
<p>Name::
Name of the Instance Type in the Provisioning Library
Code::
Useful shortcode for provisioning naming schemes and export reference.
Description::
The description of the Instance Type shown in the Provisioning Library.
255 characters max
Category::
For filtering in Instance sections and Provisioning Wizard
* Web
* SQL
* NoSLQ
* Apps
* Network
* Messaging
* Cache
* OS
* Cloud
* Utility
Icon::
Suggested Dimensions: 150 x 51
Visibility::
* Private- Only accessibly by assigned Accounts/Tenants
* Public- accessible by all Accounts/Tenants
Environment Prefix::
Used for exportable environment variables when tying instance types together environment Variables in app contexts. If not specified a name will be generated
Enable Scaling (Horizontal)::
Enables load balancer assignment and auto-scaling features
Supports Deployments::
Enables deployment features
(Requires a data volume be configured on each version. Files will be copied into this location)</p>
<p>Upon saving, this Instance Type will be available in the Provisioning Catalog, per user role access. However we still need to add layouts to the Instance Type, and prior to creating a layout, we will add a node type.</p>
</div>
<div class="section" id="node-types">
<h3>Node Types<a class="headerlink" href="#node-types" title="Permalink to this headline">¶</a></h3>
<p>salt_node_type.png</p>
<p>The following fields are for all node technology types:</p>
<ul class="simple">
<li>Name</li>
<li>Short Name</li>
<li>Version</li>
<li>Category</li>
<li>Technology</li>
</ul>
<p>** Azure
** Docker
** Google
** Hyper-V
** KVM
** Nutanix
** OpenStack
** VMware
** Xen
* Environment Variables</p>
<p>The Options fields will change depending on the Technology option selected.</p>
<p>For VM provisioning technology options, select an image from the VM Image dropdown, which is populated from the Virtual Images Section and will include images uploaded into |morpheus| , and synced images from added clouds.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Azure Marketplace images and Amazon AMI’s can now be added in the Virtual Images section for use as node types in custom library items.</p>
</div>
<p>For Docker, type in the name and version of the Docker Image and select the integrated registry.</p>
<dl class="docutils">
<dt>Expose Ports</dt>
<dd>To open port on the node, select “Add Port” and enter the name and port to expose. The Load Balancer http, https or tcp setting is only required when attaching to load balancers.</dd>
</dl>
<p>Example port configuration:</p>
<p>node_ports.png</p>
</div>
<div class="section" id="scripts-templates">
<h3>Scripts &amp; Templates<a class="headerlink" href="#scripts-templates" title="Permalink to this headline">¶</a></h3>
<p>To attach scripts and templates that have been added to the Library to a node type, start typing the name and then select the script(s) and/or template(s).</p>
<p>** Multiple scripts and templates can be added to a node type
** Scripts and Templates can be added/shared among multiple node types
** The Execution Phase can be set for scripts in the Scripts section.
** Search will populate Scripts or Templates containing the characters entered anywhere in their name, not just the first letter(s) of the name.</p>
<p>Upon save the Node Type will be created, and available for adding to layouts.</p>
</div>
<div class="section" id="layouts">
<h3>Layouts<a class="headerlink" href="#layouts" title="Permalink to this headline">¶</a></h3>
<p>salt_new_layout.png</p>
<p>Layouts are added to Instance types, and will be presented under the Configuration Options dropdown in the Provisioning Wizard for that Instance type.</p>
<p>Instance Type::
Select the Instance Type to add the new Layout to. Custom Instance Types must already be created and one layout cannot be added to multiple instance types, or change Instance Types after creation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Layouts cannot be added to |morpheus| provided library items at this time.</p>
</div>
<p>Name::
The name the layout will present as in the Configuration Options dropdown in the provisioning wizard
Version::
The version number or name for the Layout. Layouts in an Instance Type with the same version will all show under the Configuration Options dropdown when that version in selected while provisioning.
Description:: Description of the layout
Technology::
Technology determines which cloud this layout will be available for.
Environment Variables::
Nodes::
Single or multiple nodes can be added to a Layout by searching for and selecting the node(s). An example of a layout with multiple nodes is the Hyper-V MySQL Master/Slave layout pictured below (note this is the Layout detail screen after the layout has been created.)
Multi-node Layout example:</p>
<p>hyper-v_master_slave.png</p>
<p>Upon save, the layout will be attached to the selected Instance Type, and available when provisioning that Instance Type for the appropriate cloud technology.</p>
<p>salt_instance_type_layout_detail.png</p>
</div>
<div class="section" id="option-types">
<h3>Option Types<a class="headerlink" href="#option-types" title="Permalink to this headline">¶</a></h3>
<p>Option Types allow you to create additional fields within the provisioning wizard.</p>
<p>OptionType.png</p>
<p>These field entries can then be used in scripts and templates using our variable naming convention (more here).</p>
<p>variable.png</p>
</div>
<div class="section" id="option-list">
<h3>Option List<a class="headerlink" href="#option-list" title="Permalink to this headline">¶</a></h3>
<p>Much like Option Types, Option Lists allow you to give the user more choices during provisioning to then be passed to scripts and/or automation.  Option Lists, however, are pre-defined insofar as they are not free-form. They can either be manually entered CSV or JSON or they can be dynamically compiled from REST calls via GET or POST requests.</p>
<p>optionlist.png</p>
<p>OptionListREST.png</p>
<p>Your new Library Item is now ready for provisioning. Multiple Layouts with multiple technologies can be added to a single Instance Type. For example, the Layouts for the |morpheus| Apache Instance Type, with multiple layouts for many different cloud technologies and nodes is pictured below:</p>
</div>
</div>
<div class="section" id="migrations">
<h2>Migrations<a class="headerlink" href="#migrations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="migration-types">
<h3>Migration Types<a class="headerlink" href="#migration-types" title="Permalink to this headline">¶</a></h3>
<div class="section" id="hypervisor-to-hypervisor">
<h4>Hypervisor to Hypervisor<a class="headerlink" href="#hypervisor-to-hypervisor" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt>Store</dt>
<dd>|morpheus| will create a snapshot of existing VM and upload the snapshot to virtual image directory. Images that have been uploaded to the Virtual Images library can be converted to VHD, QCOW2, RAW and VMDK formats and then re-provisioned.</dd>
<dt>New</dt>
<dd>|morpheus| will create a snapshot of an existing VM, convert from source format to required destination format, and then provision the VM into the target environment.</dd>
<dt>Source</dt>
<dd>VMWare, Openstack, Xen, ESXi, Nutanix* Azure* Hyper-V* (
<a href="#id5"><span class="problematic" id="id6">*</span></a>in-development)</dd>
<dt>Destination</dt>
<dd>Softlayer, Openstack, Metapod, Xen, Amazon, VMWare, ESXi, Nutanix, Hyper-V Supported OS Type: Windows or Linux</dd>
<dt>Service Impact</dt>
<dd>Disruptive Migration</dd>
</dl>
</div>
<div class="section" id="virtual-image-extract">
<h4>Virtual Image Extract<a class="headerlink" href="#virtual-image-extract" title="Permalink to this headline">¶</a></h4>
<p>The Virtual Image extract capabilities allow for a virtual image to be extracted and stored in the virtual image repository or the image can be migrated into a cloud.</p>
<dl class="docutils">
<dt>Source</dt>
<dd>Any Cloud</dd>
<dt>Destination</dt>
<dd>SoftLayer (Only)</dd>
<dt>Supported OS Type</dt>
<dd>Windows</dd>
<dt>Service Impact</dt>
<dd>Non Disruptive</dd>
<dt>Requirements</dt>
<dd>Requires a separate disk or network share to store the image during conversion process. Capacity of the disk or network share should be sized appropriately to support the data that will be exported.</dd>
</dl>
</div>
<div class="section" id="live-stream">
<h4>Live Stream<a class="headerlink" href="#live-stream" title="Permalink to this headline">¶</a></h4>
<p>Live Stream is a linux only streaming process that will take a snapshot of a volume and allow it to be streamed to a destination linux system that is either existing or new. The destination linux must already exist and it can either be a managed or unmanaged VM in |morpheus| . The destination will be overwritten from a root level perspective.</p>
<dl class="docutils">
<dt>Source</dt>
<dd>Any Cloud</dd>
<dt>Destination</dt>
<dd>|morpheus| </dd>
<dt>Supported OS Type</dt>
<dd>Linux (Only)</dd>
<dt>Service Impact</dt>
<dd>Non Disruptive</dd>
<dt>Requirements</dt>
<dd>Requires the Linux host/guest to be configured for LVM and that free space of the capacity to be streamed is available. A destination linux host/guest must be available to receive the stream.</dd>
</dl>
</div>
</div>
<div class="section" id="add-migration">
<h3>Add Migration<a class="headerlink" href="#add-migration" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Select the Provisioning link in the navigation bar.</li>
<li>Select the Migrations link in the sub-navigations bar.</li>
<li>Click the Add Migration button.</li>
<li>From the Create Migration Wizard select the type of migration, then click the Next button.</li>
</ol>
<p>Depending on the Migration Type selected input the following, then click the Next button.</p>
<ul class="simple">
<li>Hypervisor to Hypervisor
* Select Cloud, and Server
* Input Host, Remote Port, Username, and Password</li>
<li>Virtual Image Extract
* Select Platform, Existing or New, Cloud, and Server.
* Input Host, WinRM Port, WinRM User, WinRM Password, and Snapshot path.</li>
<li>Live Stream
* Select Platform, Existing or New, Cloud, and Server
* Input Host, SSH Port, SSH User, SSH Password, Public Key, and Logical Volume Device.
* Enter Destination details, then click the Next button.</li>
</ul>
<ol class="arabic simple" start="5">
<li>Finalize your configuration if needed, then click the complete button.</li>
</ol>
</div>
<div class="section" id="manually-start-migration">
<h3>Manually Start Migration<a class="headerlink" href="#manually-start-migration" title="Permalink to this headline">¶</a></h3>
<p>If you chose to not run your migration in the Create Migration Wizard then you will be able to manually start the migration.</p>
<ol class="arabic simple">
<li>Select the Provisioning link in the navigation bar.</li>
<li>Select the Migrations link in the sub-navigations bar.</li>
<li>Click the actions dropdown of the row of the migration you wish start, and select Run.</li>
</ol>
</div>
<div class="section" id="remove-migration">
<h3>Remove Migration<a class="headerlink" href="#remove-migration" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Select the Provisioning link in the navigation bar.</li>
<li>Select the Migrations link in the sub-navigations bar.</li>
<li>Click the actions dropdown of the row of the migration you wish remove, and select Remove.</li>
</ol>
</div>
</div>
<div class="section" id="deployments">
<h2>Deployments<a class="headerlink" href="#deployments" title="Permalink to this headline">¶</a></h2>
<p>The deployments section provides very useful PaaS like capabilities when it comes to deploying applications into the newly provisioned environment. These can be uploaded directly from the UI, pulled from a build server, pulled from a public or private Git repository or even via the API and the various plugins created, such as Jenkins, and Gradle to support continuous build / integration workflows.</p>
<p>A deployment can be considered a set of versions that relate to a particular project or application being deployed. This allows one to keep track of a history of versions and easily reuse these deployment versions across instances that may exist in different environments. An example might be to deploy a version from a deployment to a staging instance and (once approved) also deployed into production.</p>
<div class="section" id="getting-started">
<h3>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h3>
<p>Getting started with deployments is easy. They can vary slightly for the application stack being deployed but the simplest phase of a deployment is adding a version and adding the appropriate files to the deployment archive that are needed for the application to run. This could be a single file like a <cite>WAR</cite> file for Tomcat, or it could be hundreds of files for stacks like <cite>Ruby on Rails</cite>.</p>
<p>There are a few ways to create a deployment. The first is to use the <cite>Provisioning -&gt; Deployments</cite> section of the application to create them. Simply add a new deployment and give it a name representing the application that is being deployed. Once a deployment is created select the deployment to view its versions (which will be empty to start). Next, its time to add a version.</p>
<p>When adding a version there are several options. There are 3 types represented by the UI. These include File, Fetch, and Git respectively. A File deployment allows the user to simply drag their files into the file explorer presented by the dialog. This file explorer can take single files or entire file trees (If files exist in subfolders then only the Chrome browser is supported due to browser limitations at the time of this writing). This is also the common type that is represented when files are uploaded via the CLI, or available build tool integration plugins. Once the files have completed their upload simply save the version for use.</p>
<div class="section" id="git">
<h4>Git<a class="headerlink" href="#git" title="Permalink to this headline">¶</a></h4>
<p>For performing git based deploys |morpheus| supports both public and private repositories. To utilize a private git repository the add version dialog will display a public keypair that can be added to the git service for authentication purposes. Currently this keypair is shared across the account and not specifically scoped to the user so it may be advisable to connect this integration to a deployment account in git. From here either a <cite>ssh</cite> or <cite>https</cite> git url can be entered along with a git branch or tag name. Once the version is saved, this repository will be copied down into the deployment archive for use.</p>
</div>
<div class="section" id="fetch">
<h4>Fetch<a class="headerlink" href="#fetch" title="Permalink to this headline">¶</a></h4>
<p>Fetch based deployments are pretty straightforward. Simply enter a url to a file representing the deployment. This can be a single file (in which case it will just be added to the deployment archive singularly) or it can be a zip file (which will automatically be expanded into the archive). HTTP Authentication options can also be entered if the url requires some form of basic authentication scheme for access by the appliance.</p>
</div>
</div>
<div class="section" id="deploying-to-an-instance">
<h3>Deploying to an Instance<a class="headerlink" href="#deploying-to-an-instance" title="Permalink to this headline">¶</a></h3>
<p>Now that a version has been added to a deployment it is easy to push that deploy out to any instance provisioned within |morpheus| . Simply navigate to the specific Instance that needs deployed to. On the Instance detail page there is a tab called <cite>Deploy</cite>. From here simply add a deploy. The dialog will ask firstly from which deployment the deploy is from (or allow you to create a new one on the spot) , and secondly which version to deploy (also with the option to add one on the fly). The next step of the wizard will display any configuration options that might be specific to the instance type being deployed to (i.e. <cite>CATALINA_OPTS</cite> for Tomcat or <cite>Java Command</cite> for java) as well as the file explorer and deployment type selections for review (or use when creating a new version on the fly). Fill in the required items then simply hit complete. The deploy will now be asynchronously sent off to all of the virtual machines or containers within the instance in a rolling restart and the deployment status will be represented.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">When deploying to an instance, the custom configuration options that were entered during the previous deployment are automatically carried forward allowing one to edit them or leave them as is.</p>
</div>
<div class="section" id="rolling-backwards-and-forwards">
<h4>Rolling Backwards and Forwards<a class="headerlink" href="#rolling-backwards-and-forwards" title="Permalink to this headline">¶</a></h4>
<p>Because of the tracked history of deployments kept within |morpheus| , the deploy tab of instance detail makes it easy to choose a previously run deployment and jump back to it in the event of a failed deployment. The history will automatically be updated and the configuration, as well as data from the previous deployment state of the instance will be restored.</p>
</div>
</div>
<div class="section" id="offloading-storage">
<h3>Offloading Storage<a class="headerlink" href="#offloading-storage" title="Permalink to this headline">¶</a></h3>
<p>Since a full history of the backup buils are kept in |morpheus| , as the appliance grows it becomes necessary to change where these are stored. On a fresh install these are stored on the local appliance in <cite>/var/opt/morpheus</cite> or wherever the master account may have changed the configuration to point to. It is also possible to adjust the deployment archive store by creating a <cite>Storage Provider</cite> tied to an S3 compatible object store, Openstack Swift object store, or any other type of mountpoint provided. This option can be adjusted in <cite>Admin-&gt;Provisioning</cite> once a storage provider is created within the account.</p>
</div>
<div class="section" id="add-deployment">
<h3>Add Deployment<a class="headerlink" href="#add-deployment" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id7">
<h4>Add Deployment<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li>Select the Provisioning link in the navigation bar.</li>
<li>Select the Deployments link in the sub-navigation bar.</li>
<li>Click the Add Deployment button.</li>
<li>Enter a Name for the deployment and a description (optional)</li>
<li>Click the Save Changes button to save.</li>
</ol>
</div>
<div class="section" id="add-version">
<h4>Add Version<a class="headerlink" href="#add-version" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li>Select the Provisioning link in the navigation bar.</li>
<li>Select the Deployments link in the sub-navigation bar.</li>
<li>Click the Name of the deployment you would like to add a version to.</li>
<li>Click the Add Version button.</li>
<li>From the Add Version Wizard select the deployment type.</li>
<li>Input the Version of the deployment.</li>
<li>Depending on the type of deployment selected perform one of the following:</li>
</ol>
<dl class="docutils">
<dt>Files</dt>
<dd>Drag files into the file explorer presented by the dialog. This file explorer can take single files or entire file trees.</dd>
<dt>Fetch</dt>
<dd>Enter a url to a file representing the deployment.</dd>
<dt>Git</dt>
<dd>The add version dialog will display a public key pair that can be added to the git service for authentication purposes. Either a ssh or https git url can be entered along with a git branch or tag name.</dd>
</dl>
<p>Click the Save Changes button to save.</p>
</div>
</div>
<div class="section" id="edit-deployment">
<h3>Edit Deployment<a class="headerlink" href="#edit-deployment" title="Permalink to this headline">¶</a></h3>
<p>To Edit Deployment:</p>
<ol class="arabic simple">
<li>Select the Provisioning link in the navigation bar.</li>
<li>Select the Deployments link in the sub-navigation bar.</li>
<li>Click the Edit Deployment icon on the row of the deployment you wish to edit.</li>
<li>Modify information as needed</li>
<li>Click the Save Changes button to save.</li>
</ol>
</div>
<div class="section" id="delete-deployment">
<h3>Delete Deployment<a class="headerlink" href="#delete-deployment" title="Permalink to this headline">¶</a></h3>
<p>To Detete Deployment:</p>
<ol class="arabic simple">
<li>Select the Provisioning link in the navigation bar.</li>
<li>Select the Deployments link in the sub-navigation bar.</li>
<li>Click the Delete Deployment icon on the row of the deployment you wish to delete.</li>
</ol>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../infrastructure/infrastructure.html" class="btn btn-neutral float-right" title="Infrastructure" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../getting_started/getting_started.html" class="btn btn-neutral" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, jw.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>